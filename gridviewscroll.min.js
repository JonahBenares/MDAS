var gridViewScroll=null;window.onload=function(){gridViewScroll=new GridViewScroll({elementID:"gvMain",width:1380,height:600,freezeColumn:!0,freezeColumnCssClass:"GridViewScrollItemFreeze",freezeFooterCssClass:"GridViewScrollFooterFreeze",freezeHeaderRowCount:2,freezeColumnCount:5,onscroll:function(c,a){console.log(c+" - "+a)}});gridViewScroll.enhance()};function getScrollPosition(){var c=gridViewScroll.scrollPosition;alert("scrollTop: "+c.scrollTop+", scrollLeft: "+c.scrollLeft)}
function setScrollPosition(){gridViewScroll.scrollPosition={scrollTop:50,scrollLeft:50}}
var GridViewScrollOptions=function(){return function(){}}(),GridViewScrollScrollPosition=function(){return function(){}}(),GridViewScroll=function(){function c(a){this._initialized=!1;null==a.elementID&&(a.elementID="");null==a.width&&(a.width="1380");null==a.height&&(a.height="600");null==a.freezeColumnCssClass&&(a.freezeColumnCssClass="");null==a.freezeFooterCssClass&&(a.freezeFooterCssClass="");null==a.freezeHeaderRowCount&&(a.freezeHeaderRowCount=1);null==a.freezeColumnCount&&(a.freezeColumnCount=
1);this.initializeOptions(a)}c.prototype.initializeOptions=function(a){this.GridID=a.elementID;this.GridWidth=a.width;this.GridHeight=a.height;this.FreezeColumn=a.freezeColumn;this.FreezeFooter=a.freezeFooter;this.FreezeColumnCssClass=a.freezeColumnCssClass;this.FreezeFooterCssClass=a.freezeFooterCssClass;this.FreezeHeaderRowCount=a.freezeHeaderRowCount;this.FreezeColumnCount=a.freezeColumnCount;this.OnScroll=a.onscroll};c.prototype.enhance=function(){this.FreezeCellWidths=[];this.IsHorizontalScrollbarEnabled=
this.IsVerticalScrollbarEnabled=!1;if(null!=this.GridID&&""!=this.GridID&&(this.ContentGrid=document.getElementById(this.GridID),null!=this.ContentGrid&&!(2>this.ContentGrid.rows.length))){this._initialized&&this.undo();this._initialized=!0;this.Parent=this.ContentGrid.parentNode;this.ContentGrid.style.display="none";if("string"==typeof this.GridWidth&&-1<this.GridWidth.indexOf("%")){var a=parseInt(this.GridWidth);this.Width=this.Parent.offsetWidth*a/100}else this.Width=parseInt(this.GridWidth);"string"==
typeof this.GridHeight&&-1<this.GridHeight.indexOf("%")?(a=parseInt(this.GridHeight),this.Height=this.Parent.offsetHeight*a/100):this.Height=parseInt(this.GridHeight);this.ContentGrid.style.display="";this.ContentGridHeaderRows=this.getGridHeaderRows();this.ContentGridItemRow=this.ContentGrid.rows.item(this.FreezeHeaderRowCount);this.ContentGridFooterRow=this.ContentGrid.rows.item(this.ContentGrid.rows.length-1);this.Content=document.createElement("div");this.Content.id=this.GridID+"_Content";this.Content.style.position=
"relative";this.Content=this.Parent.insertBefore(this.Content,this.ContentGrid);this.ContentFixed=document.createElement("div");this.ContentFixed.id=this.GridID+"_Content_Fixed";this.ContentFixed.style.overflow="auto";this.ContentFixed=this.Content.appendChild(this.ContentFixed);this.ContentGrid=this.ContentFixed.appendChild(this.ContentGrid);this.ContentFixed.style.width=String(this.Width)+"px";this.ContentGrid.offsetWidth>this.Width&&(this.IsHorizontalScrollbarEnabled=!0);this.ContentGrid.offsetHeight>
this.Height&&(this.IsVerticalScrollbarEnabled=!0);this.Header=document.createElement("div");this.Header.id=this.GridID+"_Header";this.Header.style.position="relative";this.HeaderFixed=document.createElement("div");this.HeaderFixed.id=this.GridID+"_Header_Fixed";this.HeaderFixed.style.overflow="hidden";this.Header=this.Parent.insertBefore(this.Header,this.Content);this.HeaderFixed=this.Header.appendChild(this.HeaderFixed);this.ScrollbarWidth=this.getScrollbarWidth();this.prepareHeader();this.calculateHeader();
this.Header.style.width=String(this.Width)+"px";this.IsVerticalScrollbarEnabled?(this.HeaderFixed.style.width=String(this.Width-this.ScrollbarWidth)+"px",this.IsHorizontalScrollbarEnabled&&(this.ContentFixed.style.width=this.HeaderFixed.style.width,this.isRTL()?this.ContentFixed.style.paddingLeft=String(this.ScrollbarWidth)+"px":this.ContentFixed.style.paddingRight=String(this.ScrollbarWidth)+"px"),this.ContentFixed.style.height=String(this.Height-this.Header.offsetHeight)+"px"):(this.HeaderFixed.style.width=
this.Header.style.width,this.ContentFixed.style.width=this.Header.style.width);this.FreezeColumn&&this.IsHorizontalScrollbarEnabled&&(this.appendFreezeHeader(),this.appendFreezeContent());this.FreezeFooter&&this.IsVerticalScrollbarEnabled&&(this.appendFreezeFooter(),this.FreezeColumn&&this.IsHorizontalScrollbarEnabled&&this.appendFreezeFooterColumn());var b=this;this.ContentFixed.onscroll=function(a){a=b.ContentFixed.scrollTop;var d=b.ContentFixed.scrollLeft;b.HeaderFixed.scrollLeft=d;null!=b.ContentFreeze&&
(b.ContentFreeze.scrollTop=a);null!=b.FooterFreeze&&(b.FooterFreeze.scrollLeft=d);null!=b.OnScroll&&b.OnScroll(a,d)}}};Object.defineProperty(c.prototype,"scrollPosition",{get:function(){var a=new GridViewScrollScrollPosition;a.scrollTop=this.ContentFixed.scrollTop;a.scrollLeft=this.ContentFixed.scrollLeft;return a},set:function(a){var b=a.scrollTop;a=a.scrollLeft;this.ContentFixed.scrollTop=b;this.ContentFixed.scrollLeft=a;null!=this.ContentFreeze&&(this.ContentFreeze.scrollTop=b);null!=this.FooterFreeze&&
(this.FooterFreeze.scrollLeft=a)},enumerable:!0,configurable:!0});c.prototype.getGridHeaderRows=function(){for(var a=[],b=0;b<this.FreezeHeaderRowCount;b++)a.push(this.ContentGrid.rows.item(b));return a};c.prototype.prepareHeader=function(){this.HeaderGrid=this.ContentGrid.cloneNode(!1);this.HeaderGrid.id=this.GridID+"_Header_Fixed_Grid";this.HeaderGrid=this.HeaderFixed.appendChild(this.HeaderGrid);this.prepareHeaderGridRows();for(var a=0;a<this.ContentGridItemRow.cells.length;a++)this.appendHelperElement(this.ContentGridItemRow.cells.item(a)),
this.appendHelperElement(this.HeaderGridHeaderCells[a])};c.prototype.prepareHeaderGridRows=function(){this.HeaderGridHeaderRows=[];for(var a=0;a<this.FreezeHeaderRowCount;a++){var b=this.ContentGridHeaderRows[a].cloneNode(!0);this.HeaderGridHeaderRows.push(b);this.HeaderGrid.appendChild(b)}this.prepareHeaderGridCells()};c.prototype.prepareHeaderGridCells=function(){this.HeaderGridHeaderCells=[];for(var a=0;a<this.ContentGridItemRow.cells.length;a++)for(var b in this.HeaderGridHeaderRows)for(var d=
this.HeaderGridHeaderRows[b],c=0,f=0;f<d.cells.length;f++){var e=d.cells.item(f);1==e.colSpan&&a==c?this.HeaderGridHeaderCells.push(e):c+=e.colSpan-1;c++}};c.prototype.calculateHeader=function(){for(var a=0;a<this.ContentGridItemRow.cells.length;a++){var b=this.ContentGridItemRow.cells.item(a).firstChild,d=parseInt(String(b.offsetWidth));this.FreezeCellWidths.push(d);b.style.width=d+"px";b=this.HeaderGridHeaderCells[a].firstChild;b.style.width=d+"px"}for(a=0;a<this.FreezeHeaderRowCount;a++)this.ContentGridHeaderRows[a].style.display=
"none"};c.prototype.appendFreezeHeader=function(){this.HeaderFreeze=document.createElement("div");this.HeaderFreeze.id=this.GridID+"_Header_Freeze";this.HeaderFreeze.style.position="absolute";this.HeaderFreeze.style.overflow="hidden";this.HeaderFreeze.style.top="0px";this.HeaderFreeze.style.left="0px";this.HeaderFreeze.style.width="";this.HeaderFreezeGrid=this.HeaderGrid.cloneNode(!1);this.HeaderFreezeGrid.id=this.GridID+"_Header_Freeze_Grid";this.HeaderFreezeGrid=this.HeaderFreeze.appendChild(this.HeaderFreezeGrid);
this.HeaderFreezeGridHeaderRows=[];for(var a=0;a<this.HeaderGridHeaderRows.length;a++){var b=this.HeaderGridHeaderRows[a].cloneNode(!1);this.HeaderFreezeGridHeaderRows.push(b);for(var d=0,c=0;c<this.FreezeColumnCount;){var f=this.HeaderGridHeaderRows[a].cells.item(d).cloneNode(!0);b.appendChild(f);c+=f.colSpan;d++}this.HeaderFreezeGrid.appendChild(b)}this.HeaderFreeze=this.Header.appendChild(this.HeaderFreeze)};c.prototype.appendFreezeContent=function(){this.ContentFreeze=document.createElement("div");
this.ContentFreeze.id=this.GridID+"_Content_Freeze";this.ContentFreeze.style.position="absolute";this.ContentFreeze.style.overflow="hidden";this.ContentFreeze.style.top="0px";this.ContentFreeze.style.left="0px";this.ContentFreeze.style.width="";this.ContentFreezeGrid=this.HeaderGrid.cloneNode(!1);this.ContentFreezeGrid.id=this.GridID+"_Content_Freeze_Grid";this.ContentFreezeGrid=this.ContentFreeze.appendChild(this.ContentFreezeGrid);for(var a=[],b=this.getPaddingTop(this.ContentGridItemRow.cells.item(0)),
d=this.getPaddingBottom(this.ContentGridItemRow.cells.item(0)),c=0;c<this.ContentGrid.rows.length;c++){var f=this.ContentGrid.rows.item(c),e=f.cells.item(0);"gridViewScrollHelper"!=e.firstChild.className&&this.appendHelperElement(e);var g=parseInt(String(e.offsetHeight-b-d));a.push(g);g=f.cloneNode(!1);e.cloneNode(!0);if(null!=this.FreezeColumnCssClass||""!=this.FreezeColumnCssClass)g.className=this.FreezeColumnCssClass;for(var h=e=0;h<this.FreezeColumnCount;){var k=f.cells.item(e).cloneNode(!0);
g.appendChild(k);h+=k.colSpan;e++}this.ContentFreezeGrid.appendChild(g)}for(c=0;c<this.ContentGrid.rows.length;c++)f=this.ContentGrid.rows.item(c),e=f.cells.item(0),g=this.ContentFreezeGrid.rows.item(c),b=g.cells.item(0),d=e.firstChild,d.style.height=String(a[c])+"px",d=b.firstChild,d.style.height=String(a[c])+"px";this.ContentFreeze.style.height=this.IsVerticalScrollbarEnabled?String(this.Height-this.Header.offsetHeight-this.ScrollbarWidth)+"px":String(this.ContentFixed.offsetHeight-this.ScrollbarWidth)+
"px";this.ContentFreeze=this.Content.appendChild(this.ContentFreeze)};c.prototype.appendFreezeFooter=function(){this.FooterFreeze=document.createElement("div");this.FooterFreeze.id=this.GridID+"_Footer_Freeze";this.FooterFreeze.style.position="absolute";this.FooterFreeze.style.overflow="hidden";this.FooterFreeze.style.left="0px";this.FooterFreeze.style.width=String(this.ContentFixed.offsetWidth-this.ScrollbarWidth)+"px";this.FooterFreezeGrid=this.HeaderGrid.cloneNode(!1);this.FooterFreezeGrid.id=
this.GridID+"_Footer_Freeze_Grid";this.FooterFreezeGrid=this.FooterFreeze.appendChild(this.FooterFreezeGrid);this.FooterFreezeGridHeaderRow=this.ContentGridFooterRow.cloneNode(!0);if(null!=this.FreezeFooterCssClass||""!=this.FreezeFooterCssClass)this.FooterFreezeGridHeaderRow.className=this.FreezeFooterCssClass;for(var a=0;a<this.FooterFreezeGridHeaderRow.cells.length;a++){var b=this.FooterFreezeGridHeaderRow.cells.item(a);this.appendHelperElement(b).style.width=String(this.FreezeCellWidths[a])+"px"}this.FooterFreezeGridHeaderRow=
this.FooterFreezeGrid.appendChild(this.FooterFreezeGridHeaderRow);this.FooterFreeze=this.Content.appendChild(this.FooterFreeze);a=this.ContentFixed.offsetHeight-this.FooterFreeze.offsetHeight;this.IsHorizontalScrollbarEnabled&&(a-=this.ScrollbarWidth);this.FooterFreeze.style.top=String(a)+"px"};c.prototype.appendFreezeFooterColumn=function(){this.FooterFreezeColumn=document.createElement("div");this.FooterFreezeColumn.id=this.GridID+"_Footer_FreezeColumn";this.FooterFreezeColumn.style.position="absolute";
this.FooterFreezeColumn.style.overflow="hidden";this.FooterFreezeColumn.style.left="0px";this.FooterFreezeColumn.style.width="";this.FooterFreezeColumnGrid=this.HeaderGrid.cloneNode(!1);this.FooterFreezeColumnGrid.id=this.GridID+"_Footer_FreezeColumn_Grid";this.FooterFreezeColumnGrid=this.FooterFreezeColumn.appendChild(this.FooterFreezeColumnGrid);this.FooterFreezeColumnGridHeaderRow=this.FooterFreezeGridHeaderRow.cloneNode(!1);this.FooterFreezeColumnGridHeaderRow=this.FooterFreezeColumnGrid.appendChild(this.FooterFreezeColumnGridHeaderRow);
null!=this.FreezeFooterCssClass&&(this.FooterFreezeColumnGridHeaderRow.className=this.FreezeFooterCssClass);for(var a=0,b=0;b<this.FreezeColumnCount;){var c=this.FooterFreezeGridHeaderRow.cells.item(a).cloneNode(!0);this.FooterFreezeColumnGridHeaderRow.appendChild(c);b+=c.colSpan;a++}a=this.ContentFixed.offsetHeight-this.FooterFreeze.offsetHeight;this.IsHorizontalScrollbarEnabled&&(a-=this.ScrollbarWidth);this.FooterFreezeColumn.style.top=String(a)+"px";this.FooterFreezeColumn=this.Content.appendChild(this.FooterFreezeColumn)};
c.prototype.appendHelperElement=function(a){var b=document.createElement("div");for(b.className="gridViewScrollHelper";a.hasChildNodes();)b.appendChild(a.firstChild);return a.appendChild(b)};c.prototype.getScrollbarWidth=function(){var a=document.createElement("p");a.style.width="100%";a.style.height="200px";var b=document.createElement("div");b.style.position="absolute";b.style.top="0px";b.style.left="0px";b.style.visibility="hidden";b.style.width="200px";b.style.height="150px";b.style.overflow=
"hidden";b.appendChild(a);document.body.appendChild(b);var c=a.offsetWidth;b.style.overflow="scroll";a=a.offsetWidth;c===a&&(a=b.clientWidth);document.body.removeChild(b);return c-a};c.prototype.isRTL=function(){return"rtl"===(window.getComputedStyle?window.getComputedStyle(this.ContentGrid,null).getPropertyValue("direction"):this.ContentGrid.currentStyle.direction)};c.prototype.getPaddingTop=function(a){a=window.getComputedStyle?window.getComputedStyle(a,null).getPropertyValue("padding-Top"):a.currentStyle.paddingTop;
return parseInt(a)};c.prototype.getPaddingBottom=function(a){a=window.getComputedStyle?window.getComputedStyle(a,null).getPropertyValue("padding-Bottom"):a.currentStyle.paddingBottom;return parseInt(a)};c.prototype.undo=function(){this.undoHelperElement();for(var a=0,b=this.ContentGridHeaderRows;a<b.length;a++)b[a].style.display="";this.Parent.insertBefore(this.ContentGrid,this.Header);this.Parent.removeChild(this.Header);this.Parent.removeChild(this.Content);this._initialized=!1};c.prototype.undoHelperElement=
function(){for(var a=0;a<this.ContentGridItemRow.cells.length;a++){for(var b=this.ContentGridItemRow.cells.item(a),c=b.firstChild;c.hasChildNodes();)b.appendChild(c.firstChild);b.removeChild(c)}if(this.FreezeColumn)for(a=2;a<this.ContentGrid.rows.length;a++){b=this.ContentGrid.rows.item(a).cells.item(0);for(c=b.firstChild;c.hasChildNodes();)b.appendChild(c.firstChild);b.removeChild(c)}};return c}();